var D=Object.defineProperty;var b=s=>{throw TypeError(s)};var R=(s,t,e)=>t in s?D(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var N=(s,t,e)=>R(s,typeof t!="symbol"?t+"":t,e),x=(s,t,e)=>t.has(s)||b("Cannot "+e);var a=(s,t,e)=>(x(s,t,"read from private field"),e?e.call(s):t.get(s)),l=(s,t,e)=>t.has(s)?b("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),u=(s,t,e,i)=>(x(s,t,"write to private field"),i?i.call(s,e):t.set(s,e),e),c=(s,t,e)=>(x(s,t,"access private method"),e);import{u as z,Y as d,y as I,s as M,R as T,l as W,r as C,G as y,w as S,a as Z,o as k,d as F,P as O}from"./index-CCyC0U5D.js";import{c as v}from"./tooltip-DSfp01wQ-DR9y9kLR.js";var p,w,n,o,r,A,L,E,G,H,$;const h=class h{constructor(t,e,i){l(this,r);l(this,p);l(this,w);l(this,n);l(this,o,[]);u(this,p,t),u(this,w,e),u(this,n,i)}validate(){return u(this,o,[]),c(this,r,A).call(this),c(this,r,L).call(this),c(this,r,E).call(this),c(this,r,G).call(this),c(this,r,H).call(this),c(this,r,$).call(this),{valid:a(this,o).length===0,errors:a(this,o)}}};p=new WeakMap,w=new WeakMap,n=new WeakMap,o=new WeakMap,r=new WeakSet,A=function(){a(this,n).length<h.MIN_LENGTH&&a(this,o).push(`Password must be at least ${h.MIN_LENGTH} characters long.`)},L=function(){/[A-Z]/.test(a(this,n))||a(this,o).push("Password must contain at least one uppercase letter.")},E=function(){/[a-z]/.test(a(this,n))||a(this,o).push("Password must contain at least one lowercase letter.")},G=function(){/\d/.test(a(this,n))||a(this,o).push("Password must contain at least one digit.")},H=function(){/[^a-zA-Z0-9]/.test(a(this,n))||a(this,o).push("Password must contain at least one special character (e.g., !@#$%^&*()).")},$=function(){const t=a(this,n).toLowerCase(),e=a(this,p).toLowerCase(),i=a(this,w).toLowerCase(),f=g=>{for(let m=0;m<=g.length-3;m++){const q=g.substring(m,m+3);if(t.includes(q))return!0}return!1};(f(e)||f(i))&&a(this,o).push("Password must not contain parts of your name.")},N(h,"MIN_LENGTH",12);let P=h;const _=M(({title:s,description:t})=>W({class:"flex flex-col space-y-1.5 p-6"},[C({class:"scroll-m-20 text-3xl font-bold tracking-tight"},s),t&&y({class:"text-base text-muted-foreground py-2 max-w-[700px]"},t)])),Y=(s,t)=>{if(s!==t)return app.notify({title:"Error",description:"Passwords do not match.",type:"destructive"}),!1;const e="",i="";return new P(e,i,s).validate().valid?!0:(app.notify({title:"Error",description:"Password does not meet requirements.",type:"destructive"}),!1)},j=()=>T({class:"flex flex-col p-6 pt-0",submit:(s,t)=>{s.preventDefault();const e=t.data.password,i=t.data.confirmPassword;Y(e,i)&&t.showStep("confirm")},role:"form"},[d({class:"grid gap-4"},[v({type:"password",placeholder:"New Password",required:!0,bind:"password",pattern:"(?=^.{12,}$)(?=.*[A-Z])(?=.*[a-z])(?=.*d)(?=.*W).*$",title:"Password must be at least 12 characters long and include uppercase, lowercase, number, and special character.","aria-required":!0}),v({type:"password",placeholder:"Confirm New Password",required:!0,bind:"confirmPassword",pattern:"(?=^.{12,}$)(?=.*[A-Z])(?=.*[a-z])(?=.*d)(?=.*W).*$",title:"Password must be at least 12 characters long and include uppercase, lowercase, number, and special character.","aria-required":!0}),S({type:"submit"},"Change Password")])]),U=()=>d({class:"flex flex-col items-center p-6"},[d({class:"w-16 h-16 mb-6 text-primary"},[Z(k.circleCheck)]),C({class:"text-2xl font-bold mb-4"},"All Done!"),y({class:"text-base text-muted-foreground mb-4"},"You now have completed the password change process. "),S({click:()=>{app.navigate("/")}},"Go to Home")]),B=()=>z({class:"flex flex-auto flex-col justify-center items-center"},[d({class:"rounded-xl sm:border sm:shadow-lg bg-card text-card-foreground shadow w-full mx-auto max-w-sm"},[I("step",s=>{switch(s){case"confirm":return U();default:return d([_({title:"Change Password",description:"Choose a new password. Password must be at least 12 characters long and include uppercase, lowercase, number, and special character."}),j()])}})])]),J={CHANGE_PASSWORD:"change-password",CONFIRM:"confirm"},V=F({setData(){return new O({password:"",confirmPassword:""})},setupStates(){return{step:J.CHANGE_PASSWORD}},showStep(s){this.state.step=s},render(){return d({class:"flex flex-auto flex-col"},[B()])}});export{V as ChangePasswordContainer,J as STEPS,V as default};
