import{b as u,P as l,a as p,K as h,e as w,Q as f,M as m,o as g,C as P,k as b,d as x,A as v}from"./index-BZvTxwmY.js";import{i as c}from"./tooltip-PupzYM1r-D1q7_jrM.js";class o{#e;#a;#t;#s=[];static MIN_LENGTH=12;constructor(s,t,e){this.#e=s,this.#a=t,this.#t=e}validate(){return this.#s=[],this.#r(),this.#o(),this.#i(),this.#n(),this.#l(),this.#c(),{valid:this.#s.length===0,errors:this.#s}}#r(){this.#t.length<o.MIN_LENGTH&&this.#s.push(`Password must be at least ${o.MIN_LENGTH} characters long.`)}#o(){/[A-Z]/.test(this.#t)||this.#s.push("Password must contain at least one uppercase letter.")}#i(){/[a-z]/.test(this.#t)||this.#s.push("Password must contain at least one lowercase letter.")}#n(){/\d/.test(this.#t)||this.#s.push("Password must contain at least one digit.")}#l(){/[^a-zA-Z0-9]/.test(this.#t)||this.#s.push("Password must contain at least one special character (e.g., !@#$%^&*()).")}#c(){const s=this.#t.toLowerCase(),t=this.#e.toLowerCase(),e=this.#a.toLowerCase(),i=n=>{for(let r=0;r<=n.length-3;r++){const d=n.substring(r,r+3);if(s.includes(d))return!0}return!1};(i(t)||i(e))&&this.#s.push("Password must not contain parts of your name.")}}const N=p(({title:a,description:s})=>w({class:"flex flex-col gap-y-1.5 p-6"},[f({class:"scroll-m-20 text-3xl font-bold tracking-tight"},a),s&&m({class:"text-base text-muted-foreground py-2 max-w-[700px]"},s)])),y=(a,s)=>{if(a!==s)return app.notify({title:"Error",description:"Passwords do not match.",type:"destructive"}),!1;const t="",e="";return new o(t,e,a).validate().valid?!0:(app.notify({title:"Error",description:"Password does not meet requirements.",type:"destructive"}),!1)},C=()=>h({class:"flex flex-col p-6 pt-0",submit:(a,s)=>{a.preventDefault();const t=s.data.password,e=s.data.confirmPassword;y(t,e)&&(app.notify({title:"All Done!",description:"You have successfully changed your password.",icon:g.circleCheck,type:"success"}),app.navigate(P.router.baseUrl))},role:"form"},[l({class:"grid gap-4"},[c({type:"password",placeholder:"New Password",required:!0,bind:"password",pattern:"^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)(?=.*\\W).{12,}$",title:"Password must be at least 12 characters long and include uppercase, lowercase, number, and special character.","aria-required":!0}),c({type:"password",placeholder:"Confirm New Password",required:!0,bind:"confirmPassword",pattern:"^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)(?=.*\\W).{12,}$",title:"Password must be at least 12 characters long and include uppercase, lowercase, number, and special character.","aria-required":!0}),b({type:"submit"},"Change Password")])]),L=()=>u({class:"flex flex-auto flex-col justify-center items-center"},[l({class:"rounded-xl sm:border sm:shadow-lg bg-card text-card-foreground shadow w-full mx-auto max-w-sm"},[N({title:"Change Password",description:"Choose a new password. Password must be at least 12 characters long and include uppercase, lowercase, number, and special character."}),C()])]),q=x({setData(){return new v({password:"",confirmPassword:""})},render(){return l({class:"flex flex-auto flex-col"},[L()])}});export{q as ChangePasswordContainer,q as default};
