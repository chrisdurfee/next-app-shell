import{r as b,z as l,aq as u,m as p,p as f,F as y,b as v,O as x,h as S,o as w,B as T,a2 as z,ar as F,U as C,s as D,a as M,ah as A,as as I,at as U,au as L,av as B}from"./index-CAtlfimY.js";class kt extends b{declareProps(){this.class=""}render(){return l({class:this.class||""},this.children)}}const Y=s=>{const t=new Date(s,11,31),e=new Date(s,0,1);return t.getDay()===4||e.getDay()===4},R=s=>{const t=new Date(s.valueOf()),e=(t.getDay()+6)%7;t.setDate(t.getDate()-e+3);const a=t.getFullYear(),i=new Date(a,0,4);i.setDate(i.getDate()-(i.getDay()+6)%7);const n=Math.ceil((t-i)/6048e5)+1;return n>52&&!Y(a)?{weekNumber:1,year:a+1}:{weekNumber:n,year:a}},E=(s,t,e)=>{if(e===0)return[];const a=new Date(s,t,0).getDate();return Array.from({length:e},(i,n)=>new Date(s,t-1,a-e+n+1))},G=(s,t,e)=>Array.from({length:e},(a,i)=>new Date(s,t+1,i+1)),P=(s,t)=>{const e=new Date(t,0,4),a=(e.getDay()+6)%7,i=new Date(e);i.setDate(e.getDate()-a);const n=new Date(i);return n.setDate(i.getDate()+(s-1)*7),n},O=(s,t,e)=>{const a=new Date;return a.getDate()===s&&a.getMonth()===t&&a.getFullYear()===e},V=({day:s,month:t,year:e,weekNumber:a,selectWeek:i})=>{const n=O(s,t,e);return v({text:s||"",disabled:!s,class:`
			px-2 py-1 text-center rounded-md
			${n?"bg-accent text-accent-foreground":""}
			hover:bg-primary hover:text-primary-foreground
		`,click:()=>i(a,e)})},X=(s,t)=>{const e=new Date(s,t,1).getDay(),a=new Date(s,t+1,0).getDate(),i=E(s,t,e),n=Array.from({length:a},(c,m)=>new Date(s,t,m+1)),r=(i.length+n.length)%7,d=r===0?0:7-r,o=G(s,t,d),h=[...i,...n,...o],g=[];for(let c=0;c<h.length;c+=7){const m=h.slice(c,c+7),k=m.find(N=>N)||new Date(s,t,1),{weekNumber:$,year:j}=R(k);g.push({weekNumber:$,year:j,days:m})}return g},q=({selectWeek:s})=>A("month",(t,e,{data:a})=>{const{year:i,month:n,currentDate:r}=a,d=X(i,n);return l({class:"grid grid-cols-8 gap-1 text-sm px-4 py-2"},[l({class:"text-xs text-center col-span-1 text-muted-foreground flex items-center"},"Week"),l({class:"grid grid-cols-7 col-span-7 text-center text-muted-foreground items-center"},["Su","Mo","Tu","We","Th","Fr","Sa"].map(o=>M({class:"px-1 py-1",text:o}))),...d.map(({weekNumber:o,days:h,year:g})=>l({class:"grid grid-cols-8 col-span-8 items-center ring-primary rounded-sm px-1",onSet:["currentWeek",{ring:o}]},[l({class:"font-medium text-center col-span-1 rounded-sm cursor-pointer",click:()=>s(o,g),onSet:["currentWeek",{"text-primary-foreground":o,"bg-primary":o}],text:o?`W${o}`:""}),l({class:"grid grid-cols-7 col-span-7 text-center"},h.map(c=>V({year:c?.getFullYear()||null,month:c?.getMonth()||null,day:c?.getDate()||null,weekNumber:o,selectWeek:s})))]))])}),W=({label:s,click:t})=>C({class:`
			inline-flex items-center justify-center h-7 w-7 bg-transparent p-0
			opacity-50 hover:opacity-100 text-muted-foreground absolute
			${s==="Previous"?"left-1":"right-1"}
			focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2
		  `,click:t,"aria-label":`${s} month`,variant:"icon",icon:s==="Previous"?D.chevron.single.left:D.chevron.single.right}),Q=({next:s,previous:t})=>l({class:"flex flex-auto min-h-12 text-sm font-medium relative justify-center items-center"},[M("[[monthName]] [[year]]"),W({label:"Previous",click:t}),W({label:"Next",click:s})]);class yt extends b{declareProps(){this.selectedDate=null,this.selectedWeek=null,this.selectedCallBack=null}setData(){const t=new Date,e=this.selectedWeek||this.calculateCurrentWeek(t),a=P(e,t.getFullYear());return new T({monthName:this.getMonthName(a.getMonth()),year:a.getFullYear(),month:a.getMonth(),currentDate:a.getDate(),currentWeek:e})}getSelectedDate(t){const e=this.selectedDate?new Date(this.selectedDate):t;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}calculateCurrentWeek(t){const e=new Date(t.valueOf()),a=(t.getDay()+6)%7;e.setDate(e.getDate()-a+3);const i=e.valueOf();return e.setMonth(0,1),e.getDay()!==4&&e.setMonth(0,1+(4-e.getDay()+7)%7),1+Math.ceil((i-e)/6048e5)}getMonthName(t){return z.monthNames[t]}goToPreviousMonth(){const t=this.data;let{year:e,month:a}=t;a===0?(a=11,e--):a--,this.setDate(a,e)}goToNextMonth(){const t=this.data;let{year:e,month:a}=t;a===11?(a=0,e++):a++,this.setDate(a,e)}setDate(t,e,a){this.data.set({year:e,month:t,monthName:this.getMonthName(t)}),a&&(this.data.currentDate=a)}selectWeek(t,e){this.data.currentWeek=t;const a=P(t,e);this.setDate(a.getMonth(),a.getFullYear(),a.getDate()),typeof this.selectedCallBack=="function"&&this.selectedCallBack(t)}render(){return l({class:"week-calendar-container border rounded-md p-3"},[Q({next:()=>this.goToNextMonth(),previous:()=>this.goToPreviousMonth()}),q({selectWeek:(t,e)=>this.selectWeek(t,e)})])}}const _=(s,t)=>t.includes(s),H=(s,t,e)=>s.exact?e===t:_(t,e),J=({text:s,href:t,exact:e,hidden:a})=>new S({text:s,href:t,exact:e,dataSet:["selected",["state",!0,"active"]],class:`${a?"hidden":"inline-flex"} items-center justify-center whitespace-nowrap px-3 py-1.5 text-sm font-medium transition-all rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-ring focus-visible:ring-offset-background hover:bg-primary hover:text-primary-foreground disabled:opacity-50 disabled:pointer-events-none data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm`});class wt extends b{declareProps(){this.options=[],this.class=""}beforeSetup(){this.links=[]}render(){return p({class:`flex items-center justify-center p-2 text-muted-foreground rounded-md ${this.class||""}`},[f({class:"flex gap-x-4",map:[this.options,t=>this.addLink(t)],watch:{value:["[[path]]",x.data],callBack:this.updateLinks.bind(this)}})])}afterSetup(){const t=x.data.path;this.updateLinks(t)}updateLinks(t){let e=!1;this.deactivateAllLinks();for(const i of this.links)i.rendered&&(H(i,i.getLinkPath(),t)?(this.updateLink(i,!0),e=!0):this.updateLink(i,!1));const a=this?.links[0]??null;!e&&a&&this.updateLink(a,!0)}deactivateAllLinks(){for(const t of this.links)this.updateLink(t,!1)}updateLink(t,e){t.update(e)}addLink({label:t,href:e,exact:a,hidden:i}){const n=J({text:t,href:e,exact:a,hidden:i});return this.links.push(n),n}beforeDestroy(){this.links=[]}}const K=s=>y({class:"inline-flex flex-auto items-center justify-center whitespace-nowrap rounded-sm text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm",dataStateSet:["selected",["state",s.value,"active"]]},[v({class:"flex flex-auto justify-center items-center px-3 py-1.5 rounded-md",onState:["selected",{selected:s.value}],click:t=>s.callBack(s.value)},s.label)]),Z=(s,t)=>(s.callBack=t,K(s)),tt=s=>p({class:`tab items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${s.class}`},[f({class:"flex flex-auto flex-row",map:[s.options,t=>Z(t,s.callBack)]})]);class Dt extends u{declareProps(){this.options=[],this.class="",this.callBack=null}render(){const t=this.select.bind(this);return l({class:""},[tt({class:this.class,options:this.options,callBack:t}),w({class:"tab-content",onState:["selected",this.updateContent.bind(this)]})])}getFirstValue(){return this.options[0]?.value}update(){const t=this.state.get("selected");this.select(null),this.select(t)}select(t){this.state.selected=t;const e=this.onSelect;typeof e=="function"&&e(t,this.parent)}updateContent(t){const e=this.options;if(!e||e.length<1)return;const a=e[0];for(const i of e)if(i.value===t)return i.layout;return a.layout}setupStates(){const t=this.callBack,e=typeof t;return{selected:{state:this.getFirstValue(),callBack(a){e==="function"&&t(a)}}}}}const et=s=>y({class:"inline-flex flex-auto items-center justify-center whitespace-nowrap rounded-sm text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm",dataStateSet:["selected",["state",s.value,"active"]]},[v({class:"flex flex-auto justify-center items-center px-3 py-1.5 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onState:["selected",{selected:s.value}],click:t=>s.callBack(s.value),disabled:s.disabled},s.label)]),st=(s,t)=>(s.callBack=t,et(s)),at=s=>p({class:`tab items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${s.class}`},[f({class:"flex flex-auto flex-row",map:[s.options,t=>st(t,s.callBack)]})]);class St extends u{declareProps(){this.options=[],this.class="",this.onSelect=null}render(){const t=this.select.bind(this);return at({class:this.class,options:this.options,callBack:t})}select(t){this.state.selected=t,typeof this.onSelect=="function"&&this.onSelect(t,this.parent)}setupStates(){return{selected:this.options[0]?.value||null}}}const it=(s,t)=>new RegExp(`${s}($|/|\\.).*`).test(t),nt=(s,t)=>{const e=s.getLinkPath();return s.exact?t===e:it(e,t)},rt=({text:s,href:t,exact:e})=>new S({text:s,href:t,exact:e,dataSet:["selected",["state",!0,"active"]],class:"inline-flex flex-auto items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm"});class ot extends u{declareProps(){this.options=[],this.class="",this.onSelect=null}beforeSetup(){this.links=[]}render(){return p({class:`tab items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${this.class}`},[f({class:"flex flex-auto flex-row",map:[this.options,t=>this.addLink(t)],watch:{value:["[[path]]",x.data],callBack:this.updateLinks.bind(this)}})])}afterSetup(){const t=x.data.path;this.updateLinks(t)}updateLinks(t){let e=!1,a=this.links[0];this.deactivateAllLinks();for(const i of this.links)if(i.rendered!==!1&&(e=nt(i,t),e===!0)){this.updateLink(i,!0);break}e!==!0&&a&&this.updateLink(a,!0)}deactivateAllLinks(){for(const t of this.links)this.updateLink(t,!1)}updateLink(t,e){t.update(e)}addLink({label:t,href:e,exact:a}){const i=rt({text:t,href:e,exact:a});return this.links.push(i),i}beforeDestroy(){this.links=[]}}class Lt extends u{declareProps(){this.options=[],this.class=""}render(){return l({class:"tab-panel"},[new ot({class:this.class,options:this.options}),w({class:"tab-content",switch:this.addGroup()})])}addGroup(){let t;const e=[],a=this.options;for(let i=0,n=a.length;i<n;i++)t=a[i],e.push({uri:t.uri||t.href,component:t.component||null,import:t.import||null,title:t.title||null,persist:!0});return e}}const lt=s=>y({class:"relative inline-flex items-center justify-center whitespace-nowrap text-sm font-medium text-muted-foreground transition-colors hover:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-primary after:transition-all after:duration-200 after:scale-x-0 data-[state=active]:after:scale-x-100",dataStateSet:["selected",["state",s.value,"active"]]},[v({class:"flex flex-auto justify-center items-center px-4 py-3 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",onState:["selected",{selected:s.value}],click:t=>s.callBack(s.value)},s.label)]),ct=(s,t)=>(s.callBack=t,lt(s)),ht=s=>p({class:`border-b border-border ${s.class}`},[f({class:"flex flex-row items-center",map:[s.options,t=>ct(t,s.callBack)]})]);class Bt extends u{declareProps(){this.options=[],this.class="",this.onSelect=null}render(){const t=this.select.bind(this);return l({class:"underlined-button-tab-panel flex flex-auto flex-col"},[ht({class:this.class,options:this.options,callBack:t}),w({class:"tab-content pt-6 flex flex-auto flex-col",onState:["selected",this.updateContent.bind(this)]})])}getFirstValue(){return this.options[0]?.value}select(t){this.state.selected=t;const e=this.onSelect;typeof e=="function"&&e(t,this.parent)}updateContent(t){const e=this.options;if(!e||e.length<1)return;const a=e[0];for(const i of e)if(i.value===t)return i.component;return a.component}setupStates(){const t=this.onSelect,e=typeof t;return{selected:{state:this.getFirstValue(),callBack(a){e==="function"&&t(a)}}}}}const dt=s=>y({class:"relative inline-flex items-center justify-center whitespace-nowrap text-sm font-medium text-muted-foreground transition-colors hover:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-primary after:transition-all after:duration-200 after:scale-x-0 data-[state=active]:after:scale-x-100",dataStateSet:["selected",["state",s.value,"active"]]},[v({class:"flex flex-auto justify-center items-center px-4 py-3 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",onState:["selected",{selected:s.value}],click:t=>s.callBack(s.value),disabled:s.disabled},s.label)]),ut=(s,t)=>(s.callBack=t,dt(s)),pt=s=>p({class:`border-b border-border ${s.class}`},[f({class:"flex flex-row items-center",map:[s.options,t=>ut(t,s.callBack)]})]);class Pt extends u{declareProps(){this.options=[],this.class="",this.onSelect=null}render(){const t=this.select.bind(this);return pt({class:this.class,options:this.options,callBack:t})}select(t){this.state.selected=t,typeof this.onSelect=="function"&&this.onSelect(t,this.parent)}setupStates(){return{selected:this.options[0]?.value||null}}}const ft=(s,t)=>new RegExp(`${s}($|/|\\.).*`).test(t),gt=(s,t)=>{const e=s.getLinkPath();return s.exact?t===e:ft(e,t)},mt=({text:s,href:t,exact:e})=>new S({text:s,href:t,exact:e,dataSet:["selected",["state",!0,"active"]],class:"relative inline-flex items-center justify-center whitespace-nowrap px-4 py-3 text-sm font-medium text-muted-foreground transition-colors hover:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-primary after:transition-all after:duration-200 after:scale-x-0 data-[state=active]:after:scale-x-100"});class xt extends u{declareProps(){this.options=[],this.class="",this.onSelect=null}beforeSetup(){this.links=[]}render(){return p({class:`border-b border-border ${this.class}`},[f({class:"flex flex-row items-center",map:[this.options,t=>this.addLink(t)],watch:{value:["[[path]]",x.data],callBack:this.updateLinks.bind(this)}})])}afterSetup(){const t=x.data.path;this.updateLinks(t)}updateLinks(t){let e=!1,a=this.links[0];this.deactivateAllLinks();for(const i of this.links)if(i.rendered!==!1&&(e=gt(i,t),e===!0)){this.updateLink(i,!0);break}e!==!0&&a&&this.updateLink(a,!0)}deactivateAllLinks(){for(const t of this.links)this.updateLink(t,!1)}updateLink(t,e){t.update(e)}addLink({label:t,href:e,exact:a}){const i=mt({text:t,href:e,exact:a});return this.links.push(i),i}beforeDestroy(){this.links=[]}}class Wt extends u{declareProps(){this.options=[],this.class=""}render(){return l({class:"underlined-tab-panel flex flex-auto flex-col"},[new xt({class:this.class,options:this.options}),w({class:"tab-content pt-6 flex flex-auto flex-col",switch:this.addGroup()})])}addGroup(){let t;const e=[],a=this.options;for(let i=0,n=a.length;i<n;i++)t=a[i],e.push({uri:t.uri||t.href,component:t.component||null,import:t.import||null,title:t.title||null,persist:!0});return e}}class bt extends b{onCreated(){this.lineWidth=this.lineWidth||3,this.lineColor=this.lineColor||"#000000",this.canvas=null,this.ctx=null,this.status="stopped";const t=1e3/60;this.timer=new I(t,this.draw.bind(this)),this.width=0,this.height=0,this.signed=!1,this.mouse={x:0,y:0,status:"up"},this.margin=this.margin||{x:40,y:60},this.targetSize=this.targetSize||{width:740,height:345},this.baseLineWidth=this.baseLineWidth||2,this.baseStrokeColor=this.baseStrokeColor||"#000000"}render(){return U({style:"touch-action: none; -webkit-user-select: none; -webkit-touch-callout: none;"})}beforeDestroy(){this.stopTimer()}afterSetup(){this.canvas=this.panel,this.ctx=this.canvas.getContext("2d"),globalThis.setTimeout(()=>{this.resize(),this.draw()},1)}setupEvents(){const t=this.panel,e=this.pointerPosition.bind(this),a=this.pointerUp.bind(this),i=this.pointerDown.bind(this),n=this.resize.bind(this),r={passive:!1};return[["pointermove",t,e,r],["pointerup",t,a],["pointerdown",t,i,r],["pointerout",t,a],["resize",globalThis,n]]}getEventPosition(t){let e,a;const i=this.canvas,n=i.width/parseInt(i.style.width),r=i.getBoundingClientRect();if(t.touches&&t.touches.length){const h=t.touches[0];e=h.clientX,a=h.clientY}else e=t.x||t.clientX,a=t.y||t.clientY;const d=parseInt((e-r.left)*n),o=parseInt((a-r.top)*n);this.mouse.x=d,this.mouse.y=o}pointerDown(t){t.preventDefault(),t.stopPropagation(),this.getEventPosition(t);const{ctx:e,mouse:a}=this;e.beginPath(),e.moveTo(a.x,a.y),a.status="down",this.startTimer()}pointerUp(t){t.preventDefault(),t.stopPropagation(),this.ctx.closePath(),this.mouse.status="up",this.stopTimer()}pointerPosition(t){this.getEventPosition(t),this.mouse.status==="down"&&(t.preventDefault(),t.stopPropagation())}resize(){const{canvas:t,ctx:e}=this,a=t.toDataURL();if(this.scale(),this.setupBackground(e),a!=="data:,"){const i=new globalThis.Image;L.on("load",i,function n(){e.drawImage(i,0,0),L.off("load",i,n)}),i.src=a}this.draw()}getImage(){return this.canvas.toDataURL("image/jpeg",.7)}noScaleResize(){const t=B.getSize(container);this.width=canvas.width=t.width,this.height=canvas.height=t.height}scale(){const t=this.canvas,e=this.container,a=B.getSize(e),i=this.targetSize,n=i.width,r=i.height;let d=n+"px",o=r+"px";if(this.width=t.width=n,this.height=t.height=r,a.width!==0&&a.height!==0){const h=a.width,g=a.height,c=h/n,m=g/r,k=Math.min(c,m);d=n*k+"px",o=r*k+"px"}t.style.width=d,t.style.height=o}draw(){this.mouse.status==="down"&&this.addLine(this.ctx,this.mouse.x,this.mouse.y,this.lineColor)}drawBottomLine(t){const e=this.canvas;t.globalAlpha=1,t.shadowBlur=0;const a=this.margin.x,i=this.height-this.margin.y;t.beginPath(),t.moveTo(a,i),t.lineTo(e.width-this.margin.x,i),t.lineWidth=this.baseLineWidth,t.strokeStyle=this.baseStrokeColor,t.stroke(),t.closePath()}addLine(t,e,a,i){this.signed||(this.signed=!0);const n=Math.round(e),r=Math.round(a);t.lineWidth=this.lineWidth,t.strokeStyle=i,t.lineTo(n,r),t.stroke()}reset(){this.signed=!1;const{ctx:t}=this;t.clearRect(0,0,this.width,this.height),this.setupBackground(t)}setupBackground(t){t.fillStyle="transparent",t.fillRect(0,0,this.width,this.height),this.drawBottomLine(t)}startTimer(){this.stopTimer(),this.draw(),this.timer.start(),this.status="started"}stopTimer(){this.timer.stop(),this.status="stopped"}}class Ct extends b{declareProps(){this.data=null,this.lineColor=null,this.lineWidth=null,this.baseLineWidth=null,this.baseStrokeColor=null,this.margin=null,this.targetSize=null,this.callBackData=null,this.pointerUp=null,this.path=null,this.canvasLayer=null}render(){return l({class:"signature-panel relative flex flex-auto overflow-hidden select-none"},[F({cache:"hiddenInput",required:!0,bind:this.path+".data"}),l({class:"absolute top-2 right-2"},[C({variant:"icon",icon:D.circleX,click:this.reset.bind(this)})]),new bt({cache:"canvasLayer",margin:this.margin,targetSize:this.targetSize,lineColor:this.lineColor,lineWidth:this.lineWidth,baseLineWidth:this.baseLineWidth,baseStrokeColor:this.baseStrokeColor,pointerUpCallBack:this.pointerUp,callBackData:this.callBackData})])}afterSetup(){this.canvasLayer.resize()}getImage(){return this.canvasLayer.getImage()}isSigned(){return this.canvasLayer?this.canvasLayer.signed:!1}reset(t){if(this.canvasLayer)return this.canvasLayer.reset()}beforeDestroy(){this.canvasLayer=null,this.hiddenInput=null}}export{Wt as A,yt as C,Ct as F,Bt as I,wt as M,Dt as N,kt as P,Pt as U,St as j,ot as l,Lt as z};
