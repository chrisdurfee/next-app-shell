import{H as M,I as Y,J as l,e as u,K as S,l as F,N as U,D as x,y as k,E as d,B as v,L,Q as y,A as T,S as I,U as N,V as Q,X as H,$ as O,a0 as K,s as X,Z as D,j as G,o as b,b as C,a1 as V,T as q,_ as g,a2 as _,m as z,a3 as J,a4 as Z,a5 as ee,a6 as R,a7 as B,a8 as te}from"./index-octsXI_q.js";import{c as se,G as ae,L as ie}from"./tooltip-iKwNah4y-CAkT0ueT.js";class Ve extends d{declareProps(){this.class=""}render(){return l({class:this.class||""},this.children)}}const ne=t=>{const e=new Date(t,11,31),s=new Date(t,0,1);return e.getDay()===4||s.getDay()===4},le=t=>{const e=new Date(t.valueOf()),s=(e.getDay()+6)%7;e.setDate(e.getDate()-s+3);const a=e.getFullYear(),i=new Date(a,0,4);i.setDate(i.getDate()-(i.getDay()+6)%7);const n=Math.ceil((e-i)/6048e5)+1;return n>52&&!ne(a)?{weekNumber:1,year:a+1}:{weekNumber:n,year:a}},oe=(t,e,s)=>{if(s===0)return[];const a=new Date(t,e,0).getDate();return Array.from({length:s},(i,n)=>new Date(t,e-1,a-s+n+1))},re=(t,e,s)=>Array.from({length:s},(a,i)=>new Date(t,e+1,i+1)),W=(t,e)=>{const s=new Date(e,0,4),a=(s.getDay()+6)%7,i=new Date(s);i.setDate(s.getDate()-a);const n=new Date(i);return n.setDate(i.getDate()+(t-1)*7),n},ce=(t,e,s)=>{const a=new Date;return a.getDate()===t&&a.getMonth()===e&&a.getFullYear()===s},de=({day:t,month:e,year:s,weekNumber:a,selectWeek:i})=>{const n=ce(t,e,s);return L({text:t||"",disabled:!t,class:`
			px-2 py-1 text-center rounded-md
			${n?"bg-accent text-accent-foreground":""}
			hover:bg-primary hover:text-primary-foreground
		`,click:()=>i(a,s)})},he=(t,e)=>{const s=new Date(t,e,1).getDay(),a=new Date(t,e+1,0).getDate(),i=oe(t,e,s),n=Array.from({length:a},(c,m)=>new Date(t,e,m+1)),o=(i.length+n.length)%7,p=o===0?0:7-o,r=re(t,e,p),h=[...i,...n,...r],f=[];for(let c=0;c<h.length;c+=7){const m=h.slice(c,c+7),w=m.find(E=>E)||new Date(t,e,1),{weekNumber:j,year:A}=le(w);f.push({weekNumber:j,year:A,days:m})}return f},ue=({selectWeek:t})=>I("month",(e,s,{data:a})=>{const{year:i,month:n,currentDate:o}=a,p=he(i,n);return l({class:"grid grid-cols-8 gap-1 text-sm px-4 py-2"},[l({class:"text-xs text-center col-span-1 text-muted-foreground flex items-center"},"Week"),l({class:"grid grid-cols-7 col-span-7 text-center text-muted-foreground items-center"},["Su","Mo","Tu","We","Th","Fr","Sa"].map(r=>D({class:"px-1 py-1",text:r}))),...p.map(({weekNumber:r,days:h,year:f})=>l({class:"grid grid-cols-8 col-span-8 items-center ring-primary rounded-sm px-1",onSet:["currentWeek",{ring:r}]},[l({class:"font-medium text-center col-span-1 rounded-sm cursor-pointer",click:()=>t(r,f),onSet:["currentWeek",{"text-primary-foreground":r,"bg-primary":r}],text:r?`W${r}`:""}),l({class:"grid grid-cols-7 col-span-7 text-center"},h.map(c=>de({year:(c==null?void 0:c.getFullYear())||null,month:(c==null?void 0:c.getMonth())||null,day:(c==null?void 0:c.getDate())||null,weekNumber:r,selectWeek:t})))]))])}),P=({label:t,click:e})=>C({class:`
			inline-flex items-center justify-center h-7 w-7 bg-transparent p-0
			opacity-50 hover:opacity-100 text-muted-foreground absolute
			${t==="Previous"?"left-1":"right-1"}
			focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2
		  `,click:e,"aria-label":`${t} month`,variant:"icon",icon:t==="Previous"?b.chevron.single.left:b.chevron.single.right}),pe=({next:t,previous:e})=>l({class:"flex flex-auto min-h-12 text-sm font-medium relative justify-center items-center"},[D("[[monthName]] [[year]]"),P({label:"Previous",click:e}),P({label:"Next",click:t})]);class qe extends d{declareProps(){this.selectedDate=null,this.selectedWeek=null,this.selectedCallBack=null}setData(){const e=new Date,s=this.selectedWeek||this.calculateCurrentWeek(e),a=W(s,e.getFullYear());return new S({monthName:this.getMonthName(a.getMonth()),year:a.getFullYear(),month:a.getMonth(),currentDate:a.getDate(),currentWeek:s})}getSelectedDate(e){const s=this.selectedDate?new Date(this.selectedDate):e;return new Date(s.getFullYear(),s.getMonth(),s.getDate())}calculateCurrentWeek(e){const s=new Date(e.valueOf()),a=(e.getDay()+6)%7;s.setDate(s.getDate()-a+3);const i=s.valueOf();return s.setMonth(0,1),s.getDay()!==4&&s.setMonth(0,1+(4-s.getDay()+7)%7),1+Math.ceil((i-s)/6048e5)}getMonthName(e){return J.monthNames[e]}goToPreviousMonth(){const e=this.data;let{year:s,month:a}=e;a===0?(a=11,s--):a--,this.setDate(a,s)}goToNextMonth(){const e=this.data;let{year:s,month:a}=e;a===11?(a=0,s++):a++,this.setDate(a,s)}setDate(e,s,a){this.data.set({year:s,month:e,monthName:this.getMonthName(e)}),a&&(this.data.currentDate=a)}selectWeek(e,s){this.data.currentWeek=e;const a=W(e,s);this.setDate(a.getMonth(),a.getFullYear(),a.getDate()),typeof this.selectedCallBack=="function"&&this.selectedCallBack(e)}render(){return l({class:"week-calendar-container border rounded-md p-3"},[pe({next:()=>this.goToNextMonth(),previous:()=>this.goToPreviousMonth()}),ue({selectWeek:(e,s)=>this.selectWeek(e,s)})])}}const fe=(t,e)=>{const s=t.toggleAllSelectedRows();e.state.checked=!s},me=t=>O({class:`cursor-pointer py-3 px-4 text-base w-10 ${t.class||""}`},[X(e=>new ie({class:"mr-2",onChange:(s,a)=>fe(e,a)}))]),ge=({align:t,sortable:e,key:s,label:a,sort:i,class:n})=>{const o=t||"justify-start";return O({class:`cursor-pointer py-3 px-4 text-base ${n||""}`,click:e&&(()=>i(s))},[l({class:`flex flex-auto w-full items-center ${o}`},[D(a),e&&G({class:"ml-2",html:b.arrows.upDown})])])},$=t=>Q([K({class:"text-muted-foreground border-b",map:[t.headers,e=>e.label==="checkbox"?me({toggle:t.toggle}):ge({align:e.align,sortable:e.sortable,key:e.key,label:e.label,sort:t.sort})]})]),xe=({key:t,rows:e,selectRow:s,rowItem:a,emptyState:i})=>new H({cache:"list",key:t,items:e,rowItem:n=>a(n,s),class:"divide-y divide-border",emptyState:i});class we extends d{setData(){let e=this.rows&&this.rows.length>0;return(this.loadMoreItems||this.tableData)&&!e&&(e=null),new S({selectedRows:[],hasItems:e,selected:!1})}toggleAllSelectedRows(){const e=this.list.getRows(),s=this.data.selectedRows.length===e.length,a=s?[]:e;return this.data.selectedRows=a,this.updateSelected(),this.updateTable(!s),s}updateSelected(){const e=this.data.get("selectedRows");this.data.selected=e.length>0}getSelectedRows(){return this.data.get("selectedRows")}updateTable(e){const s=this.list.getRows();s.forEach(a=>a.selected=e),this.list.setRows(s)}selectRow(e){const s=e.selected??!1;e.selected=!s;const a=this.data.get("selectedRows"),i=e.selected?[...a,e]:a.filter(n=>n!==e);this.data.selectedRows=i,this.updateSelected()}render(){const e=this.rows,s=this.border!==!1?"border":"";return l({class:"w-full flex flex-auto flex-col"},[I("hasItems",a=>a===!1&&this.emptyState?this.emptyState():null),l({class:`w-full rounded-md ${s} overflow-x-auto`,onSet:["hasItems",{hidden:!1}]},[N({class:"w-full"},[this.headers&&$({headers:this.headers,sort:a=>this.sortRows(a)}),this.customHeader??null,xe({key:this.key,rows:e,selectRow:this.selectRow.bind(this),rowItem:this.rowItem,emptyState:this.emptyState})])])])}remove(e){this.list.remove(e)}setRows(e){this.list.setRows(e)}append(e){this.list.append(e)}mingle(e,s=!1){this.list.mingle(e,s)}prepend(e){this.list.prepend(e)}beforeDestroy(){this.data.selectedRows=[]}}const ye=t=>new te({cache:"list",scrollContainer:t.scrollContainer,loadMoreItems:t.loadMoreItems,offset:t.offset,limit:t.limit,key:t.key,tableData:t.tableData,items:t.items,rowItem:e=>t.rowItem(e,t.selectRow),class:"divide-y divide-border"});class be extends we{render(){const e=this.rows,s=this.border!==!1?"border":"";return l({class:"w-full flex flex-auto flex-col"},[I("hasItems",a=>a===!1&&this.emptyState?this.emptyState():null),l({class:`w-full rounded-md ${s} overflow-x-auto`,onSet:["hasItems",{hidden:!1}]},[N({class:"w-full"},[this.headers&&$({headers:this.headers,sort:a=>this.sortRows(a)}),this.customHeader??null,ye({scrollContainer:this.scrollContainer,loadMoreItems:this.loadMoreItems,offset:this.offset,limit:this.limit,class:this.class,tableData:this.tableData,key:this.key,items:e,selectRow:this.selectRow.bind(this),rowItem:this.rowItem})])])])}refresh(){this.list.refresh()}}const _e=u(t=>new be({cache:t.cache??"list",tableData:t.data,scrollContainer:t.scrollContainer,loadMoreItems:t.loadMoreItems,offset:t.offset,limit:t.limit,class:t.class,key:t.key,rows:t.rows,rowItem:t.rowItem,headers:t.headers,customHeader:t.customHeader,border:t.border,emptyState:t.emptyState})),ke=u(({name:t,email:e})=>l({class:"min-w-0 flex-auto"},[g({class:"text-base font-semibold leading-6 m-0"},t),g({class:"truncate text-sm leading-5 text-muted-foreground m-0"},e)])),ve=()=>l({class:"flex items-center gap-x-1.5"},[l({class:"flex-none rounded-full bg-emerald-500/20 p-1"},[l({class:"h-1.5 w-1.5 rounded-full bg-emerald-500"})]),g({class:"text-xs leading-5 text-gray-500"},"Online")]),De=t=>g({class:"text-xs leading-5 text-muted-foreground"},[D("Last seen "),_({datetime:t},"3h ago")]),Se=(t,e)=>t==="online"?ve():De(e),Le=u(({role:t,lastSeen:e,status:s})=>l({class:"hidden shrink-0 sm:flex sm:flex-col sm:items-end"},[g({class:"text-sm leading-6 m-0"},t),Se(s,e)])),Ie=t=>t.split(" ").map(e=>e[0]).join(""),Ce=u(t=>k({class:"fadeIn flex justify-between gap-x-6 py-4 px-4 rounded-md hover:bg-muted/50"},[l({class:"flex min-w-0 gap-x-4"},[q({src:t.image,alt:t.name,fallbackText:Ie(t.name)}),ke({name:t.name,email:t.email})]),Le({role:t.role,lastSeen:t.lastSeen,status:t.status})])),Je=u(t=>new V({cache:"list",key:"name",items:t.users,role:"list",class:"divide-y divide-border",rowItem:Ce})),Re=(t,e)=>e.includes(t),Be=(t,e,s)=>t.exact?s===e:Re(e,s),We=({text:t,href:e,exact:s,hidden:a})=>new T({text:t,href:e,exact:s,dataSet:["selected",["state",!0,"active"]],class:`${a?"hidden":"inline-flex"} items-center justify-center whitespace-nowrap px-3 py-1.5 text-sm font-medium transition-all rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-ring focus-visible:ring-offset-background hover:bg-primary hover:text-primary-foreground disabled:opacity-50 disabled:pointer-events-none data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm`});class Ze extends d{declareProps(){this.options=[],this.class=""}beforeSetup(){this.links=[]}render(){return v({class:`flex items-center justify-center p-2 text-muted-foreground rounded-md ${this.class||""}`},[x({class:"flex space-x-4",map:[this.options,e=>this.addLink(e)],watch:{value:["[[path]]",y.data],callBack:this.updateLinks.bind(this)}})])}afterSetup(){const e=y.data.path;this.updateLinks(e)}updateLinks(e){let s=!1;this.deactivateAllLinks();for(const a of this.links)a.rendered&&(Be(a,a.getLinkPath(),e)?(this.updateLink(a,!0),s=!0):this.updateLink(a,!1));!s&&this.links[0]&&this.updateLink(this.links[0],!0)}deactivateAllLinks(){for(const e of this.links)this.updateLink(e,!1)}updateLink(e,s){e.update(s)}addLink({label:e,href:s,exact:a,hidden:i}){const n=We({text:e,href:s,exact:a,hidden:i});return this.links.push(n),n}beforeDestroy(){this.links=[]}}const et=u(t=>{const e=t.margin||"m-4 ml-0";return t.allowHistory=t.allowHistory===!0,l({class:`flex-none ${e}`},[C({variant:"back",class:"ghost",...t})])});class Pe extends d{declareProps(){this.class=""}render(){return l({class:this.getClassName(),onSet:["loading",{loading:!0}]},[this.addBody()])}getClassName(){return"overlay absolute top-[0px] left-0 bottom-0 right-0 flex-col bg-background z-20 lg:z-10 flex flex-auto lg:left-[64px] lg:top-0 overflow-y-visible will-change-contents "+(this.class||"")}setContainer(e){this.container=app.root}setupStates(){return{loading:!1}}addLoading(){this.state.loading=!0}removeLoading(){this.state.loading=!1}addBody(){return l({class:"body fadeIn flex flex-auto flex-col"},this.getContents())}getContents(){return this.children}}M.addType("dockableOverlay",t=>{if(!t)return;const e=t.component;e&&e.rendered===!0&&e.state.docked===!1&&e.destroy()});class tt extends Pe{onCreated(){this.dockSize=this.maxSize||1024}render(){const e=this.container;return l({onState:[["loading",{loading:!0}],["docked",(s,a)=>{s?(a.className=this.getDockedClassName(),e.appendChild(a),document.documentElement.style.overflowY="auto"):(a.className=this.getClassName(),app.root.appendChild(a),document.documentElement.style.overflowY="hidden")}]]},[this.addBody()])}getDockedClassName(){return"flex flex-auto flex-col bg-background flex will-change-contents "+(this.class||"")}setup(e){this.container=e,this.initialize()}setupStates(){return{loading:!1,docked:this.canDock()}}afterSetup(){M.add(this.container,"dockableOverlay",{component:this}),this.onResize()}setupEvents(){return[["resize",globalThis,()=>this.onResize()]]}canDock(){return globalThis.innerWidth>=this.dockSize}onResize(){this.state.docked=this.canDock()}beforeDestroy(){document.documentElement.style.overflowY="auto"}}const Me=u(({index:t,click:e,state:s},a)=>k({class:"p-2 cursor-pointer hover:bg-muted/50",onState:[[s,"selectedIndex",{"bg-accent":t,"text-white":t}]],click:()=>e(t)},a)),Te=u(({selectOption:t,state:e})=>x({class:"border rounded-md list-none m-0 p-0 max-h-[400px] overflow-y-auto",for:["filteredOptions",(s,a)=>Me({index:a,click:t,state:e},s.label)]})),Ne=u(t=>l({class:"relative flex items-center"},[se({cache:"input",class:t.class??"",placeholder:t.placeholder??"Search...",bind:t.bind??[t.state,"searchQuery"],keyup:(e,s)=>{s.state&&(s.state.open=!1),typeof t.filterOptions=="function"&&t.filterOptions(),s.dropdown&&s.dropdown.updatePosition(),t.keyup&&t.keyup(e,s)},pointerup:(e,s)=>{typeof s.toggleDropdown=="function"&&s.toggleDropdown()},keydown:e=>[typeof t.handleKeyDown=="function"&&t.handleKeyDown(e)]}),t.icon&&l({class:"absolute flex right-0 mr-2"},[F(t.icon)])])),Oe=t=>l({class:"relative flex fle-auto flex-col",onState:["open",(e,s,a)=>{if(e)return new U({cache:"dropdown",parent:a,button:a.input,size:"xl"},[Te(t)])}]}),st=Y({setData(){const t=this.options||[];return new S({options:t,filteredOptions:t})},state(){return{searchQuery:"",selectedIndex:-1,open:!1}},setSelectedIndexByQuery(){const t=this.data.filteredOptions;let{searchQuery:e}=this.state;e=e.toLowerCase();const s=t.findIndex(a=>a.label.toLowerCase()===e);s>=0&&(this.state.selectedIndex=s)},filterOptions(){const t=this.state.searchQuery.toLowerCase();if(t===""||t.length===0){this.data.filteredOptions=this.data.options;return}const e=this.data.get("options");this.data.filteredOptions=e.filter(s=>s.label.toLowerCase().includes(t))},getValue(){const{selectedIndex:t}=this.state;return t<0?null:this.data.get(`filteredOptions[${t}]`)},selectOption(t){this.state.selectedIndex=t;const e=this.data.get(`filteredOptions[${t}]`);this.state.searchQuery=e.label,this.state.open=!1,typeof this.onSelect=="function"&&this.onSelect(e)},toggleDropdown(){this.state.toggle("open"),this.state.open&&this.setSelectedIndexByQuery()},handleKeyDown(t){const e=this.data.filteredOptions,{selectedIndex:s}=this.state;t.key==="ArrowDown"?(t.preventDefault(),this.state.selectedIndex=Math.min(s+1,e.length-1)):t.key==="ArrowUp"?(t.preventDefault(),this.state.selectedIndex=Math.max(s-1,0)):t.key==="Enter"&&s>=0&&(t.preventDefault(),this.selectOption(s))},render(){return l({class:"relative w-full max-w-md"},[Ne({state:this.state,icon:this.icon,placeholder:this.placeholder,filterOptions:this.filterOptions.bind(this),handleKeyDown:this.handleKeyDown.bind(this)}),Oe({state:this.state,setSelected:this.setSelectedIndexByQuery.bind(this),selectOption:this.selectOption.bind(this)})])}}),ze=t=>k({class:"inline-flex flex-auto items-center justify-center whitespace-nowrap rounded-sm text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm",dataSet:["selected",["state",t.value,"active"]]},[L({class:"flex flex-auto justify-center items-center px-3 py-1.5 rounded-md",onSet:["selected",{selected:t.value}],click:e=>t.callBack(t.value)},t.label)]),$e=(t,e)=>(t.callBack=e,ze(t)),je=t=>v({class:`tab items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${t.class}`},[x({class:"flex flex-auto flex-row",map:[t.options,e=>$e(e,t.callBack)]})]);class at extends d{declareProps(){this.options=[],this.class="",this.callBack=null}render(){const e=this.select.bind(this);return l({class:""},[je({class:this.class,options:this.options,callBack:e}),z({class:"tab-content",onState:["selected",this.updateContent.bind(this)]})])}getFirstValue(){var e;return(e=this.options[0])==null?void 0:e.value}update(){const e=this.state.get("selected");this.select(null),this.select(e)}select(e){this.state.selected=e}updateContent(e){const s=this.options;if(!s||s.length<1)return;const a=s[0];for(const i of s)if(i.value===e)return i.layout;return a.layout}setupStates(){const e=this.callBack,s=typeof e;return{selected:{state:this.getFirstValue(),callBack(a){s==="function"&&e(a)}}}}}const Ae=t=>k({class:"inline-flex flex-auto items-center justify-center whitespace-nowrap rounded-sm text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm",dataSet:["selected",["state",t.value,"active"]]},[L({class:"flex flex-auto justify-center items-center px-3 py-1.5 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onSet:["selected",{selected:t.value}],click:e=>t.callBack(t.value),disabled:t.disabled},t.label)]),Ee=(t,e)=>(t.callBack=e,Ae(t)),Ye=t=>v({class:`tab items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${t.class}`},[x({class:"flex flex-auto flex-row",map:[t.options,e=>Ee(e,t.callBack)]})]);class it extends d{declareProps(){this.options=[],this.class="",this.onSelect=null}render(){const e=this.select.bind(this);return Ye({class:this.class,options:this.options,callBack:e})}select(e){this.state.selected=e,typeof this.onSelect=="function"&&this.onSelect(e,this.parent)}setupStates(){var e;return{selected:((e=this.options[0])==null?void 0:e.value)||null}}}const Fe=(t,e)=>new RegExp(`${t}($|/|\\.).*`).test(e),Ue=(t,e)=>{const s=t.getLinkPath();return t.exact?e===s:Fe(s,e)},Qe=({text:t,href:e,exact:s})=>new T({text:t,href:e,exact:s,dataSet:["selected",["state",!0,"active"]],class:"inline-flex flex-auto items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground data-[state=active]:shadow-sm"});class He extends d{declareProps(){this.options=[],this.class="",this.onSelect=null}beforeSetup(){this.links=[]}render(){return v({class:`tab items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${this.class}`},[x({class:"flex flex-auto flex-row",map:[this.options,e=>this.addLink(e)],watch:{value:["[[path]]",y.data],callBack:this.updateLinks.bind(this)}})])}afterSetup(){const e=y.data.path;this.updateLinks(e)}updateLinks(e){let s=!1,a=this.links[0];this.deactivateAllLinks();for(const i of this.links)if(i.rendered!==!1&&(s=Ue(i,e),s===!0)){this.updateLink(i,!0);break}s!==!0&&a&&this.updateLink(a,!0)}deactivateAllLinks(){for(const e of this.links)this.updateLink(e,!1)}updateLink(e,s){e.update(s)}addLink({label:e,href:s,exact:a}){const i=Qe({text:e,href:s,exact:a});return this.links.push(i),i}beforeDestroy(){this.links=[]}}class nt extends d{declareProps(){this.options=[],this.class=""}render(){return l({class:"tab-panel"},[new He({class:this.class,options:this.options}),z({class:"tab-content",switch:this.addGroup()})])}addGroup(){let e;const s=[],a=this.options;for(let i=0,n=a.length;i<n;i++)e=a[i],s.push({uri:e.uri||e.href,component:e.component,title:e.title||null,persist:!0});return s}}class Ke extends d{onCreated(){this.lineWidth=this.lineWidth||3,this.lineColor=this.lineColor||"#000000",this.canvas=null,this.ctx=null,this.status="stopped";const e=1e3/60;this.timer=new Z(e,this.draw.bind(this)),this.width=0,this.height=0,this.signed=!1,this.mouse={x:0,y:0,status:"up"},this.margin=this.margin||{x:40,y:60},this.targetSize=this.targetSize||{width:740,height:345},this.baseLineWidth=this.baseLineWidth||2,this.baseStrokeColor=this.baseStrokeColor||"#000000"}render(){return ee({style:"touch-action: none; -webkit-user-select: none; -webkit-touch-callout: none;"})}beforeDestroy(){this.stopTimer()}afterSetup(){this.canvas=this.panel,this.ctx=this.canvas.getContext("2d"),globalThis.setTimeout(()=>{this.resize(),this.draw()},1)}setupEvents(){const e=this.panel,s=this.pointerPosition.bind(this),a=this.pointerUp.bind(this),i=this.pointerDown.bind(this),n=this.resize.bind(this),o={passive:!1};return[["pointermove",e,s,o],["pointerup",e,a],["pointerdown",e,i,o],["pointerout",e,a],["resize",globalThis,n]]}getEventPosition(e){let s,a;const i=this.canvas,n=i.width/parseInt(i.style.width),o=i.getBoundingClientRect();if(e.touches&&e.touches.length){const h=e.touches[0];s=h.clientX,a=h.clientY}else s=e.x||e.clientX,a=e.y||e.clientY;const p=parseInt((s-o.left)*n),r=parseInt((a-o.top)*n);this.mouse.x=p,this.mouse.y=r}pointerDown(e){e.preventDefault(),e.stopPropagation(),this.getEventPosition(e);const{ctx:s,mouse:a}=this;s.beginPath(),s.moveTo(a.x,a.y),a.status="down",this.startTimer()}pointerUp(e){e.preventDefault(),e.stopPropagation(),this.ctx.closePath(),this.mouse.status="up",this.stopTimer()}pointerPosition(e){this.getEventPosition(e),this.mouse.status==="down"&&(e.preventDefault(),e.stopPropagation())}resize(){const{canvas:e,ctx:s}=this,a=e.toDataURL();if(this.scale(),this.setupBackground(s),a!=="data:,"){const i=new globalThis.Image;R.on("load",i,function n(){s.drawImage(i,0,0),R.off("load",i,n)}),i.src=a}this.draw()}getImage(){return this.canvas.toDataURL("image/jpeg",.7)}noScaleResize(){const e=B.getSize(container);this.width=canvas.width=e.width,this.height=canvas.height=e.height}scale(){const e=this.canvas,s=this.container,a=B.getSize(s),i=this.targetSize,n=i.width,o=i.height;let p=n+"px",r=o+"px";if(this.width=e.width=n,this.height=e.height=o,a.width!==0&&a.height!==0){const h=a.width,f=a.height,c=h/n,m=f/o,w=Math.min(c,m);p=n*w+"px",r=o*w+"px"}e.style.width=p,e.style.height=r}draw(){this.mouse.status==="down"&&this.addLine(this.ctx,this.mouse.x,this.mouse.y,this.lineColor)}drawBottomLine(e){const s=this.canvas;e.globalAlpha=1,e.shadowBlur=0;const a=this.margin.x,i=this.height-this.margin.y;e.beginPath(),e.moveTo(a,i),e.lineTo(s.width-this.margin.x,i),e.lineWidth=this.baseLineWidth,e.strokeStyle=this.baseStrokeColor,e.stroke(),e.closePath()}addLine(e,s,a,i){this.signed||(this.signed=!0);const n=Math.round(s),o=Math.round(a);e.lineWidth=this.lineWidth,e.strokeStyle=i,e.lineTo(n,o),e.stroke()}reset(){this.signed=!1;const{ctx:e}=this;e.clearRect(0,0,this.width,this.height),this.setupBackground(e)}setupBackground(e){e.fillStyle="transparent",e.fillRect(0,0,this.width,this.height),this.drawBottomLine(e)}startTimer(){this.stopTimer(),this.draw(),this.timer.start(),this.status="started"}stopTimer(){this.timer.stop(),this.status="stopped"}}class lt extends d{declareProps(){this.data=null,this.lineColor=null,this.lineWidth=null,this.baseLineWidth=null,this.baseStrokeColor=null,this.margin=null,this.targetSize=null,this.callBackData=null,this.pointerUp=null,this.path=null,this.canvasLayer=null}render(){return l({class:"signature-panel relative flex flex-auto overflow-hidden select-none"},[ae({cache:"hiddenInput",required:!0,bind:this.path+".data"}),l({class:"absolute top-2 right-2"},[C({variant:"icon",icon:b.circleX,click:this.reset.bind(this)})]),new Ke({cache:"canvasLayer",margin:this.margin,targetSize:this.targetSize,lineColor:this.lineColor,lineWidth:this.lineWidth,baseLineWidth:this.baseLineWidth,baseStrokeColor:this.baseStrokeColor,pointerUpCallBack:this.pointerUp,callBackData:this.callBackData})])}afterSetup(){this.canvasLayer.resize()}getImage(){return this.canvasLayer.getImage()}isSigned(){return this.canvasLayer?this.canvasLayer.signed:!1}reset(e){if(this.canvasLayer)return this.canvasLayer.reset()}}export{Pe as A,He as K,Ne as N,Ce as R,Ve as a,me as b,Je as c,Ze as d,lt as e,st as g,et as h,we as j,at as m,qe as o,it as p,_e as r,tt as u,nt as w,ge as y};
